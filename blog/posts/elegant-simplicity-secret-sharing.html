<!DOCTYPE html>
<html lang="en">
   <head>
       <meta charset="utf-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no">
<title>The Power of Elegant Simplicity #1: Shamir's Secret Sharing - The Polynomial That Guards Your Secrets &#9642; Extiri Blog</title>
<!--
<meta name="description" content="Part of the “The Power of Elegant Simplicity” series - algorithms that hide power in plain sight You know what’s wild? One of the most elegant cryptographic algorithms ever invented uses nothing more than high school algebra. No complex number theory, no quantum mechanics, just polynomials. The kind you probably...">
-->
<meta name="description" content="blog about Extiri, programming and cybersecurity
">
<meta name="keywords" content="fun-facts, The Power of Elegant Simplicity">
<link rel="canonical" href="https://extiri.com/posts/elegant-simplicity-secret-sharing">
<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="The Power of Elegant Simplicity #1: Shamir's Secret Sharing - The Polynomial That Guards Your Secrets" />
<meta name="twitter:description" content="blog about Extiri, programming and cybersecurity
" />
<meta name="twitter:image" content="https://extiri.com" />
<meta name="author" content="">
<link rel="author" href="">
<meta property="og:locale" content="">
<meta property="og:type" content="article">
<meta property="og:title" content="The Power of Elegant Simplicity #1: Shamir's Secret Sharing - The Polynomial That Guards Your Secrets">
<meta property="og:description" content="blog about Extiri, programming and cybersecurity
">
<meta property="og:url" content="https://extiri.com/posts/elegant-simplicity-secret-sharing">
<meta property="og:site_name" content="Extiri Blog">
<link rel="stylesheet" href="/blog/assets/vendor/normalize-css/normalize.css">
<link rel="stylesheet" href="/blog/assets/css/main.css">
<link rel="stylesheet" href="/blog/assets/css/bf.css">
   <body>
       <div class="wrapper" id="blep">
          <header class="site-header">
 <div class="site-header__inner">
    <a class="site-header__brand" href="/blog/index.html">
      <span class="site-header__logo">
        <object type="image/svg+xml" data="/blog/assets/img/guy.svg" class="logosvg">Your browser does not support svg images</object>
      </span>
      <span class="site-header__title">Extiri Blog</span>
    </a>
    <button
      class="site-nav__toggle"
      type="button"
      aria-label="Toggle navigation"
      aria-expanded="false"
      aria-controls="site-nav"
      data-nav-toggle
    >
      <span></span>
      <span></span>
      <span></span>
    </button>
   <nav class="site-nav" id="site-nav" data-site-nav>
     <ul class="site-nav__list">
       <li><a href="/blog/about/index.html">About</a>
       <li><a href="/blog/archive/index.html">Archive</a>
       <li><a href="https://extiri.com">Apps</a>
     </ul>
     <div class="site-nav__secondary">
       <ul class="site-nav__social">
         <li>
            <a href="https://youtube.com/@wiktorwojcik3678" target="_blank" rel="noopener">
              <span class="icon-youtube"></span>
              <span class="sr-only">YouTube</span>
            </a>
         <li>
            <a href="https://twitter.com/WiktorW2" target="_blank" rel="noopener">
              <span class="icon-twitter"></span>
              <span class="sr-only">Twitter</span>
            </a>
         <li>
            <a href="https://github.com/Extiri" target="_blank" rel="noopener">
              <span class="icon-github"></span>
              <span class="sr-only">GitHub</span>
            </a>
         <li>
            <a href="mailto:wiktor.wojcik@extiri.com">
              <span class="icon-mail_outline"></span>
              <span class="sr-only">Email</span>
            </a>
         <li>
            <a href="/blog/feed.xml">
              <span class="icon-rss_feed"></span>
              <span class="sr-only">RSS feed</span>
            </a>
       </ul>
     </div>
   </nav>
 </div>
</header>
<div id="cookie-consent-banner" class="cookie-consent-banner" aria-live="polite" hidden>
 <div class="cookie-consent-content">
   <p>We use cookies and analytics to improve this site. You can accept or decline analytics tracking. Read our <a href="/blog/privacy_policy.html">Privacy Policy</a>.
   <div class="cookie-consent-buttons">
      <button id="consent-accept" class="button-primary">Accept</button>
      <button id="consent-decline" class="button-secondary">Decline</button>
   </div>
 </div>
</div>
<article class="post">
<header class="post-hero">
   <p class="post-hero__eyebrow">Extiri Blog
   <h1 class="post-hero__title">The Power of Elegant Simplicity #1: Shamir's Secret Sharing - The Polynomial That Guards Your Secrets</h1>
   <div class="post-hero__meta">
      <span class="post-hero__date">
        February 8, 2026
      </span>
      <span class="post-hero__divider">•</span>
      <span class="post-hero__author">
        Wiktor Wójcik
      </span>
      <span class="post-hero__divider">•</span>
      <span class="post-hero__tags">
          <a href="/blog/tag/fun-facts/index.html">#fun-facts</a>
          <a href="/blog/tag/The Power of Elegant Simplicity/index.html">#The Power of Elegant Simplicity</a>
      </span>
   </div>
 </header>
 <div class="post-content">
   <p><em>Part of the “The Power of Elegant Simplicity” series - algorithms that hide power in plain sight</em>
<hr />
<p>You know what’s wild? One of the most elegant cryptographic algorithms ever invented uses nothing more than high school algebra. No complex number theory, no quantum mechanics, just polynomials. The kind you probably learned to hate in 9th grade.
<p>Welcome to Shamir’s Secret Sharing, where a simple quadratic equation becomes the foundation for securing nuclear launch codes, cryptocurrency wallets, and anything else you really, <em>really</em> don’t want falling into the wrong hands.
<h2 id="the-problem-trust-no-one-but-trust-everyone-together">The Problem: Trust No One (But Trust Everyone Together)</h2>
<p>Imagine you’re a startup founder with the keys to your company’s crypto wallet. If you keep them yourself, you’re one bike accident away from locking everyone out forever. If you give copies to your co-founders, any one of them could clean out the account and disappear to Bali.
<p>What you need is a way to split a secret so that:
<ul>
 <li>No single person can reconstruct it alone
 <li>But any group of, say, 3 out of 5 people can work together to recover it
 <li>People who don’t have enough shares learn absolutely nothing (not “almost nothing” - literally nothing)
</ul>
<p>This is exactly what Adi Shamir figured out in 1979. And the solution is beautifully simple.
<p><img src="/blog/assets/img/shamir_infographic.png" alt="A visualization of the algorithm" />
<h2 id="the-trick-its-just-a-polynomial">The Trick: It’s Just a Polynomial</h2>
<p>Here’s the entire algorithm in one sentence: <strong>encode your secret as a point on a polynomial, give each person a different point, and use the magic of polynomial interpolation to reconstruct it.</strong>
<p>That’s it. No, really.
<p>Let’s break it down with an example where we want 3 people to be able to reconstruct the secret, out of 6 total people (k=3, n=6).
<h3 id="step-1-encode-your-secret">Step 1: Encode Your Secret</h3>
<p>Let’s say your secret is the number 8 (maybe it’s a password hash, or a piece of an encryption key).
<p>Create a polynomial of degree k-1 (so degree 2 in our case) where the constant term is your secret:
<div class="language-plaintext highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre><td class="code"><pre>f(x) = 3x² + 5x + 8
</pre></table>
</div>
</div>
<p>The coefficients 3 and 5? Completely random. Throw dice. Mash your keyboard. Doesn’t matter. But that 8? That’s your secret, hiding in plain sight at f(0).
<h3 id="step-2-generate-the-shares">Step 2: Generate the Shares</h3>
<p>Now just evaluate your polynomial at different points:
<div class="language-python highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26</pre><td class="code"><pre><span class="k">def</span> <span class="nf">create_shares</span><span class="p">(</span><span class="n">secret</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="s">"""
    Split a secret into n shares where k shares are needed to reconstruct.
    
    Args:
        secret: The secret value to share
        k: Minimum number of shares needed to reconstruct
        n: Total number of shares to create
    """</span>
    <span class="kn">import</span> <span class="nn">random</span>
    
    <span class="c"># Create a polynomial of degree k-1 with secret as constant term</span>
    <span class="n">coefficients</span> <span class="o">=</span> <span class="p">[</span><span class="n">secret</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span>
    
    <span class="k">def</span> <span class="nf">polynomial</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">coef</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">**</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">coef</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">coefficients</span><span class="p">))</span>
    
    <span class="c"># Generate n shares by evaluating polynomial at different points</span>
    <span class="n">shares</span> <span class="o">=</span> <span class="p">[(</span><span class="n">i</span><span class="p">,</span> <span class="n">polynomial</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">shares</span>

<span class="c"># Example usage</span>
<span class="n">secret</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">shares</span> <span class="o">=</span> <span class="n">create_shares</span><span class="p">(</span><span class="n">secret</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="c"># With coefficients [8, 5, 3] this gives us:</span>
<span class="c"># [(1, 16), (2, 30), (3, 50), (4, 76), (5, 108), (6, 146)]</span>
</pre></table>
</div>
</div>
<p>Give person #1 the point (1, 16), person #2 gets (2, 30), and so on. These are your shares.
<h3 id="step-3-the-magic-of-reconstruction">Step 3: The Magic of Reconstruction</h3>
<p>Here’s where it gets cool. With fewer than 3 shares, there are <strong>infinitely many</strong> polynomials that fit through those points. Just like two points define a line but could be part of any parabola, two shares from our 2nd-degree polynomial could match an infinite number of possible secrets.
<p>But the moment you have 3 shares, boom - there’s exactly one polynomial of degree 2 that fits through all three points. Mathematics locks it in.
<p>We use Lagrange interpolation to reconstruct the polynomial:
<div class="language-python highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28</pre><td class="code"><pre><span class="k">def</span> <span class="nf">lagrange_interpolation</span><span class="p">(</span><span class="n">shares</span><span class="p">):</span>
    <span class="s">"""
    Reconstruct the secret using Lagrange interpolation.
    
    Args:
        shares: List of (x, y) tuples representing shares
    
    Returns:
        The secret (value at x=0)
    """</span>
    <span class="k">def</span> <span class="nf">basis_polynomial</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="s">"""Calculate the i-th Lagrange basis polynomial at x"""</span>
        <span class="n">xi</span><span class="p">,</span> <span class="n">yi</span> <span class="o">=</span> <span class="n">shares</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">yi</span>
        
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="p">(</span><span class="n">xj</span><span class="p">,</span> <span class="n">yj</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">shares</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="n">j</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">*=</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">xj</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">xi</span> <span class="o">-</span> <span class="n">xj</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">result</span>
    
    <span class="c"># Evaluate the interpolated polynomial at x=0 to get the secret</span>
    <span class="n">secret</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">basis_polynomial</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">shares</span><span class="p">)))</span>
    <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="n">secret</span><span class="p">)</span>

<span class="c"># Reconstruct with any 3 shares</span>
<span class="n">secret_recovered</span> <span class="o">=</span> <span class="n">lagrange_interpolation</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">76</span><span class="p">)])</span>
<span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s">"Secret: {secret_recovered}"</span><span class="p">)</span>  <span class="c"># Output: Secret: 8</span>
</pre></table>
</div>
</div>
<p>The polynomial gets reconstructed, and f(0) gives us back our secret.
<h2 id="why-this-is-actually-mind-blowing">Why This is Actually Mind-Blowing</h2>
<p><strong>Perfect Security</strong>: If you have k-1 shares, you have zero information about the secret. Not “very little” - literally zero. The secret could be any value with equal probability. This is information-theoretic security, the same kind that makes one-time pads unbreakable.
<p><strong>Flexibility</strong>: Want to go from 5 shares to 10? Just evaluate the same polynomial at new points — instant new shares. Want to update the secret entirely? Generate a new polynomial and distribute fresh shares. One caveat: if you need to change the <em>threshold</em> (say, from “3 of 5” to “4 of 7”), that means a new polynomial of a different degree, so you’d need to redistribute all shares.
<p><strong>Simplicity</strong>: The entire algorithm fits in a tweet. Okay, maybe a long tweet. But still.
<h2 id="real-world-applications">Real-World Applications</h2>
<p>This isn’t just a clever party trick. Shamir’s Secret Sharing is used in:
<ul>
 <li><strong>Cryptocurrency wallets</strong>: Splitting recovery seeds across multiple devices or people
 <li><strong>Certificate authorities</strong>: Requiring multiple executives to sign off on root certificates
 <li><strong>Nuclear launch codes</strong>: Academic example because you definitely want more than one person to agree on this
 <li><strong>Distributed password managers</strong>: Like Hashicorp Vault’s unseal process
 <li><strong>Threshold signatures</strong>: Multiple parties cooperating to sign transactions
</ul>
<h2 id="the-catch-theres-always-a-catch">The Catch (There’s Always a Catch)</h2>
<p>Like most cryptographic primitives, the devil is in the implementation details:
<ol>
 <li>
   <p><strong>Random number generation matters</strong>: Those random coefficients need to come from a cryptographically secure random number generator (CSPRNG), like Python’s <code class="language-plaintext highlighter-rouge">secrets</code> module. The standard <code class="language-plaintext highlighter-rouge">random</code> module is a regular PRNG — predictable if someone knows the seed. (The code examples in this post use <code class="language-plaintext highlighter-rouge">random</code> for clarity, but don’t do that in production.)
 <li>
   <p><strong>Share storage is critical</strong>: Each share is as sensitive as the original secret. If someone gets k shares, game over.
 <li>
   <p><strong>No integrity protection (mostly)</strong>: Basic Shamir doesn’t have built-in authentication, but here’s a neat trick — if you collect <em>more</em> than the minimum k shares, you can catch liars. Just try reconstructing from different subsets of k shares. If everyone’s honest, every subset gives the same secret. If someone faked their share, the subsets containing it will produce a different result, exposing the liar. Fair warning: this gets expensive fast (the number of subsets grows combinatorially), so it’s more of a sanity check than a scalable defense. For real-world use, look into verifiable schemes like Feldman’s VSS or Pedersen’s VSS.
 <li>
   <p><strong>Computation in finite fields</strong>: For production use, you need to work in finite fields (modulo a large prime) to avoid floating-point precision issues and information leakage.
 <li>
   <p><strong>Other production concerns</strong>: A full deployment would also want share authentication (MACs or signatures on each share), replay protection, and possibly proactive secret sharing — periodically refreshing shares without changing the secret. These are beyond our scope here, but worth knowing about if you ever build this for real.
</ol>
<h2 id="the-modular-twist-from-theory-to-practice">The Modular Twist: From Theory to Practice</h2>
<p>That last point deserves its own section, because it’s both important and surprisingly simple.
<p>Everything I explained above works <em>algebraically</em> over the real numbers — the polynomial math is correct, and you’ll get your secret back. But here’s the thing: over ℝ, the scheme doesn’t actually provide information-theoretic security. The range and magnitude of the share values can leak information about the secret. The “zero knowledge with k-1 shares” guarantee <strong>only holds in a finite field</strong>. So modular arithmetic isn’t just a practical fix for computers — it’s a security requirement. Let me explain.
<h3 id="why-modular-arithmetic">Why Modular Arithmetic?</h3>
<p><strong>Problem 1: Floating-point chaos</strong>
<p>When you reconstruct a polynomial using Lagrange interpolation with real numbers, you’re doing lots of divisions. These create fractions that computers represent as floating-point numbers. After a few operations, you might get <code class="language-plaintext highlighter-rouge">7.999999999998</code> instead of <code class="language-plaintext highlighter-rouge">8</code>. Usually you can just round, but what if your secret is <code class="language-plaintext highlighter-rouge">7</code> or <code class="language-plaintext highlighter-rouge">8</code>? At scale, these errors compound.
<p><strong>Problem 2: Information leakage</strong>
<p>Here’s a subtler issue. If someone has k-1 shares and sees the intermediate calculations, the <em>size</em> of those numbers might reveal information about the secret. In real arithmetic, evaluating a degree-2 polynomial at x=100 gives much bigger results for some coefficients than others. An attacker could use this to narrow down possibilities.
<p><strong>The solution: Work modulo a prime</strong>
<p>Instead of doing arithmetic over all real numbers, we do everything modulo a large prime number <code class="language-plaintext highlighter-rouge">p</code>. This means:
<ul>
 <li>All values stay in the range [0, p-1]
 <li>No floating-point numbers at all - everything is integers
 <li>Division becomes “multiplication by the modular inverse”
 <li>Every value is equally likely, revealing nothing
</ul>
<h3 id="how-simple-is-the-change">How Simple Is The Change?</h3>
<p>Remarkably simple. Take any operation from the basic algorithm and add <code class="language-plaintext highlighter-rouge">% prime</code> at the end:
<div class="language-python highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5</pre><td class="code"><pre><span class="c"># Basic (problematic)</span>
<span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="n">result</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">coef</span><span class="p">)</span>

<span class="c"># Modular (production-ready)  </span>
<span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="n">result</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">coef</span><span class="p">)</span> <span class="o">%</span> <span class="n">prime</span>
</pre></table>
</div>
</div>
<p>The only tricky part is division. In modular arithmetic, you can’t just divide - instead, you multiply by the <strong>modular inverse</strong>. If you want to compute <code class="language-plaintext highlighter-rouge">a / b mod p</code>, you calculate <code class="language-plaintext highlighter-rouge">a * (b^(-1)) mod p</code>, where <code class="language-plaintext highlighter-rouge">b^(-1)</code> is the number such that <code class="language-plaintext highlighter-rouge">b * b^(-1) ≡ 1 (mod p)</code>.
<p>Python 3.8+ makes this trivial:
<div class="language-python highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2</pre><td class="code"><pre><span class="c"># Division in modular arithmetic</span>
<span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">prime</span><span class="p">))</span> <span class="o">%</span> <span class="n">prime</span>
</pre></table>
</div>
</div>
<p>That’s it. The entire conceptual framework - polynomials, shares, interpolation - stays exactly the same. You’re just doing the arithmetic in a different “universe” where numbers wrap around at <code class="language-plaintext highlighter-rouge">prime</code>.
<h3 id="choosing-your-prime">Choosing Your Prime</h3>
<p>The prime <code class="language-plaintext highlighter-rouge">p</code> needs to be larger than:
<ol>
 <li>Your secret value
 <li>The number of shares you’ll create
</ol>
<p>A common choice is a Mersenne prime like <code class="language-plaintext highlighter-rouge">2³¹ - 1</code> or, for cryptographic applications, a 256-bit prime. The “Try It Yourself” example below uses modular arithmetic properly.
<h2 id="try-it-yourself">Try It Yourself</h2>
<p>Here’s a complete, simple implementation you can play with:
<div class="language-python highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48</pre><td class="code"><pre><span class="kn">import</span> <span class="nn">random</span>

<span class="k">def</span> <span class="nf">create_shares</span><span class="p">(</span><span class="n">secret</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">prime</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="s">"""Create n shares of a secret with threshold k"""</span>
    <span class="k">if</span> <span class="n">prime</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">prime</span> <span class="o">=</span> <span class="mi">2</span><span class="o">**</span><span class="mi">31</span> <span class="o">-</span> <span class="mi">1</span>  <span class="c"># Mersenne prime for simplicity</span>
    
    <span class="c"># Random coefficients for polynomial</span>
    <span class="n">coefficients</span> <span class="o">=</span> <span class="p">[</span><span class="n">secret</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">prime</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]</span>
    
    <span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="s">"""Evaluate polynomial at x using Horner's method"""</span>
        <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">coef</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">coefficients</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="n">result</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">coef</span><span class="p">)</span> <span class="o">%</span> <span class="n">prime</span>
        <span class="k">return</span> <span class="n">result</span>
    
    <span class="c"># Generate shares</span>
    <span class="n">shares</span> <span class="o">=</span> <span class="p">[(</span><span class="n">i</span><span class="p">,</span> <span class="n">evaluate</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">shares</span><span class="p">,</span> <span class="n">prime</span>

<span class="k">def</span> <span class="nf">reconstruct_secret</span><span class="p">(</span><span class="n">shares</span><span class="p">,</span> <span class="n">prime</span><span class="p">):</span>
    <span class="s">"""Reconstruct secret from shares using Lagrange interpolation"""</span>
    <span class="n">secret</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">yi</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">shares</span><span class="p">):</span>
        <span class="n">numerator</span> <span class="o">=</span> <span class="n">denominator</span> <span class="o">=</span> <span class="mi">1</span>
        
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="p">(</span><span class="n">xj</span><span class="p">,</span> <span class="n">_</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">shares</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="n">j</span><span class="p">:</span>
                <span class="n">numerator</span> <span class="o">=</span> <span class="p">(</span><span class="n">numerator</span> <span class="o">*</span> <span class="p">(</span><span class="mi">0</span> <span class="o">-</span> <span class="n">xj</span><span class="p">))</span> <span class="o">%</span> <span class="n">prime</span>
                <span class="n">denominator</span> <span class="o">=</span> <span class="p">(</span><span class="n">denominator</span> <span class="o">*</span> <span class="p">(</span><span class="n">xi</span> <span class="o">-</span> <span class="n">xj</span><span class="p">))</span> <span class="o">%</span> <span class="n">prime</span>
        
        <span class="c"># Modular inverse for division in finite field</span>
        <span class="n">lagrange_coef</span> <span class="o">=</span> <span class="p">(</span><span class="n">numerator</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="n">denominator</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">prime</span><span class="p">))</span> <span class="o">%</span> <span class="n">prime</span>
        <span class="n">secret</span> <span class="o">=</span> <span class="p">(</span><span class="n">secret</span> <span class="o">+</span> <span class="n">yi</span> <span class="o">*</span> <span class="n">lagrange_coef</span><span class="p">)</span> <span class="o">%</span> <span class="n">prime</span>
    
    <span class="k">return</span> <span class="n">secret</span>

<span class="c"># Example</span>
<span class="n">secret</span> <span class="o">=</span> <span class="mi">12345</span>
<span class="n">shares</span><span class="p">,</span> <span class="n">prime</span> <span class="o">=</span> <span class="n">create_shares</span><span class="p">(</span><span class="n">secret</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">prime</span><span class="o">=</span><span class="mi">104729</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s">"Original secret: {secret}"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s">"Shares: {shares[:3]}"</span><span class="p">)</span>  <span class="c"># Show first 3 shares</span>

<span class="c"># Reconstruct with any 3 shares</span>
<span class="n">recovered</span> <span class="o">=</span> <span class="n">reconstruct_secret</span><span class="p">(</span><span class="n">shares</span><span class="p">[:</span><span class="mi">3</span><span class="p">],</span> <span class="n">prime</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s">"Recovered secret: {recovered}"</span><span class="p">)</span>
</pre></table>
</div>
</div>
<h2 id="the-takeaway">The Takeaway</h2>
<p>Shamir’s Secret Sharing is sneakily brilliant because it looks so simple. Polynomials? We learned those in high school. But that simplicity hides incredible power: a mathematically perfect way to split trust, with security properties that hold up against even quantum computers.
<p>Sometimes the best algorithms aren’t the most complex ones. Sometimes they’re the ones that make you slap your forehead and think, “why didn’t I think of that?”
<p>That’s the beauty of elegantly simple algorithms. They hide in plain sight, doing impossible-seeming things with elementary mathematics.
<hr />
<p><em>Next in the series: Bloom Filters - The data structure that’s okay with being wrong (sometimes)</em>
<p><strong>Further Reading:</strong>
<ul>
 <li><a href="https://dl.acm.org/doi/10.1145/359168.359176">Shamir’s original 1979 paper</a> - Surprisingly readable
 <li><a href="https://en.wikipedia.org/wiki/Shamir%27s_Secret_Sharing">Implementation considerations for production systems</a>
 <li>Example implementation: <a href="https://github.com/wiktorwojcik112/secret_sharing">Secret Sharing Demo</a>
</ul>
 </div>
</article>
<aside class="related">
<h2>Related posts</h2>
<ul class="related-posts">
</aside>
           <footer class="site-footer">
 <div class="site-footer__inner">
   <div class="site-footer__primary">
     <h2>Extiri Blog</h2>
     <p>blog about Extiri, programming and cybersecurity
   </div>
   <nav class="site-footer__links" aria-label="Footer navigation">
      <a href="/blog/about/index.html">About</a>
      <a href="/blog/archive/index.html">Archive</a>
      <a href="https://extiri.com">Apps</a>
      <a href="/blog/feed.xml">RSS</a>
   </nav>
   <div class="site-footer__meta">
      <span>Crafted by Wiktor Wójcik</span>
      <span>&copy; 2026 Extiri</span>
   </div>
 </div>
</footer>
       </div>
<script type="text/javascript" src="/blog/assets/js/nav.js"></script>
<script type="text/javascript" src="/blog/assets/js/theme.js"></script>
<script type="text/javascript" src="/blog/assets/js/barefoot.js"></script>
<script type="text/javascript" src="/blog/assets/js/consent.js"></script>
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-HLY6ZZMNBQ"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);} 
    // Default to denied until the user accepts
    gtag('consent', 'default', { 'analytics_storage': 'denied' });
    gtag('js', new Date());
    gtag('config', 'G-HLY6ZZMNBQ', { 'anonymize_ip': true });
    // Listen for our custom consent event to enable analytics
    window.addEventListener('extiri:consent', function (e) {
      if (e && e.detail && e.detail.analytics) {
        // Grant analytics consent
        gtag('consent', 'update', { 'analytics_storage': 'granted' });
      } else {
        // Revoke analytics consent
        gtag('consent', 'update', { 'analytics_storage': 'denied' });
      }
    });
  </script>
    
